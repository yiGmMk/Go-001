## 毕业项目

项目基于beego框架，使用beego默认生成的目录结构，每个服务一套，大致的目录结构如下

`

controller

dto

model

service

...

`

优化方向

- 目录结构和初始化

   只有一套服务还好说，多个服务就有多套这样的目录，初始化都是手写代码，在main里起gouroutine。感觉还是使用wire来处理，对各种依赖关系比较清晰，原来的代码里面只能靠看代码逻辑。目录结构改造后可以将多个服务放在一起，减少一些重复代码，公用的代码和服务内部的代码也可以通过internal目录区分开。

  在https://github.com/golang-standards/project-layout里推荐的项目目录和课上推荐的大同小异，感觉按照这样去设计实现会清晰很多。

- 日志处理

  原本在服务中的日志处理像是错误示例，在3层代码里处处打日志，最坑的是日志里面每一层的堆栈信息不全，数量多对错误的定位查找也不方便。使用github.com/pkg/errors包处理错误，记录一次错误避免处处写日志，这样使用之后清晰了很多。

  日志只写一次，堆栈信息带入一次，避免多次携带堆栈信息，使用WithMessage可以加入描述。

- go协程使用

  在beego里框架做一些处理，在接口中panic之后有框架帮忙recover住，所以在一些使用goroutine协程的没有对panic的处理。

  后面在这一块会使用errgroup，有context上下文和对go协程的一些处理更加方便，应该同时加上对panic的处理而不是全部依赖框架，也方便加上错误日志进行定位。

- 在缓存方面

  缓存方面用的redis，和数据库的一致性保证

## 项目总结

​	通过这门课见识了很多，一些微服务中的痛点和解决方案确实有效，带入到工作中帮助不小，也有一些在目前工作中没有用上的的，但开阔了视野，至少以后遇到问题有了方向。在微服务这一块还有很多要学习的地方。

